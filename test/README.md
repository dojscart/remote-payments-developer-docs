# Remote Payments Developer Documentation

To verify the Open API spec generated by the documents conforms to the real api we are using a tool called Dredd (https://dredd.org).

Dredd will:
- Take the Open API description document for the Payment Intents api 
- Create expectations based on requests and responses documented
- Make requests to a staging version of the API
- Checks the API responses match the documented responses

The output of the test is a verified contract, giving confidence that the real api matches the documentation.

## Setup

- Install Node JS (https://nodejs.org/en/)
- Install Dredd
```
npm install dredd@12.1.0 --global
```

- Install test dependencies
```
git clone git@github.com:Dojo-Engineering/remote-payments-developer-docs.git
cd /remote-payments-developer-docs/test
npm install
```

## Optional - run payments intent service locally

Currently the tests run against the a local running version of payment intents, this is temporary until security credentials can be set up to hit the staging endpoints. Follow the set up process for the payment intents api and run on http://localhost:5000

```
git clone git@github.com:Dojo-Engineering/remote-payments-payment-intents.git
cd /remote-payments-payment-intent
dotnet run --project Dojo.RemotePayments.PaymentIntents
```

## Run contract test

All endpoints:
```
cd /remote-payments-developer-docs/test
npm test
```

Single endpoint:
```
cd /remote-payments-developer-docs/test

export TEST_API="Api Name" && npm run test-only
e.g export TEST_API="Payment intents > /api/payment-intents > PaymentIntents_CreatePaymentIntent > 200 > application/json" && npm run test-only
```
